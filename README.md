# Мульти‑проекция экранов телефонов на Windows (через интернет)

В архиве два подхода:

## (A) Быстрый и практичный: **scrcpy + Tailscale** (Android)
- Плюсы: запускается за 10–20 минут, стабильная картинка, поддерживает 5+ телефонов, минимум кода.
- Минусы: нужен Android (iOS не поддерживается). Нужен доступ к режиму разработчика для ADB по сети.
- Идея: на каждый телефон ставим Tailscale, включаем ADB по TCP/IP (по Tailscale‑IP), запускаем `scrcpy` на Windows для каждого устройства — получаем 5+ окон с онлайн‑экранами.

## (B) Кастомное решение: **WebRTC** (Android Sender + Windows/Electron Viewer + Node.js сигнальный сервер)
- Плюсы: работает через NAT/интернет, авто‑масштабирование 5+ экранов в одном окне, можно допилить под любые задачи.
- Минусы: нужна сборка Android‑приложения (Kotlin), установка Node.js, и, для гарантии работы за NAT, свой TURN‑сервер.

---

## Что выбрать?
- Если у вас **Android‑устройства** и нужна скорость — берите (A) scrcpy + Tailscale.
- Если нужно продакшн‑решение с одной плиточной панелью 5+ экранов в **одном окне** — берите (B) WebRTC.

---

## (A) Быстрый вариант: scrcpy + Tailscale

### Что потребуется
1. **Windows** ПК.
2. Устройства **Android 8+** (на каждом — включить “Режим разработчика” → “Отладка по USB”).
3. Установить **Tailscale** на ПК и на телефоны, войти в одну сеть (Tailnet).
4. Установить **scrcpy** на Windows: https://github.com/Genymobile/scrcpy/releases

### Шаги настройки (на каждом телефоне)
1. Подключите телефон к ПК по USB *один раз*.
2. Разрешите отладку (USB‑debugging).
3. Включите отладку по сети:
   ```bash
   adb tcpip 5555
   adb shell getprop net.ipv4.ip_forwarding
   ```
   (последняя команда не обязательна; главное — узнать **Tailscale‑IP** устройства через приложение Tailscale на телефоне).
4. Отключите USB. На ПК выполните:
   ```bash
   adb connect <TAILSCALE_IP_ТЕЛЕФОНА>:5555
   adb devices
   ```
   Должно появиться устройство `ip:5555` в списке.

### Запуск многих окон сразу
- Отредактируйте файл `quick-scrcpy/devices.txt`, впишите по одному **Tailscale‑IP:5555** на строку (для 5+ телефонов — 5+ строк).
- Запустите на Windows файл `quick-scrcpy\start_all.ps1` (правой кнопкой → Run with PowerShell).
- Откроются окна scrcpy, одно на каждый телефон (масштаб можно менять параметрами).

### Горячие параметры scrcpy (в скрипте уже выставлены)
- `--max-size 1280` — ограничить длинную сторону, экономит трафик и CPU.
- `--bit-rate 4M` — битрейт.
- `--no-audio` — без аудио, чтобы не грузить сеть.
- `--stay-awake` — экран не гаснет во время трансляции.

> Совет: Сверху можно поставить **Tiled**/FancyZones/PowerToys для автокладки 5+ окон плиткой.

---

## (B) Кастомное WebRTC‑решение

### Компоненты
- `signaling-server/` — WebSocket сервер (Node.js) для сигналинга (обмена SDP/ICE).
- `viewer-electron/` — Windows просмотрщик (Electron), укладывает 1–16 потоков плиткой.
- `android-sender/` — Android‑приложение: захват экрана (MediaProjection) → WebRTC публикация.

### Быстрый старт (локально/LAN)
1. Установите Node.js 18+.
2. В папке `signaling-server/`:
   ```bash
   npm i
   node server.js
   ```
   Сервер по умолчанию слушает `ws://0.0.0.0:8080`.
3. В `viewer-electron/`:
   ```bash
   npm i
   npm start
   ```
   Введите адрес сигналинга (например, `ws://<IP_ПК>:8080`) и имя “комнаты” (например, `room1`).
4. Соберите и установите APK из `android-sender/` на телефоны, введите тот же адрес сигналинга и комнату, нажмите **Start** на каждом — экраны появятся плиткой.

### Интернет/NAT
Для работы через разные сети потребуется **TURN**‑сервер (например, Coturn). Пропишите его URL/логин/пароль в конфиге `viewer-electron/src/config.js` и `android-sender/app/src/main/java/.../RtcConfig.kt`.

---

## iOS
Полноценный захват всего экрана на iOS требует **ReplayKit Broadcast Upload Extension** и публикации через WebRTC/RTMP; в архиве нет готового iOS‑клиента. Если понадобится, добавлю шаблон под iOS с ReplayKit.

---

## Поддержка/доработка
- Могу добавить авто‑расстановку 5–16 плиток, запись потока, шифрование, авторизацию по токенам, агрегацию 20+ устройств.
- Для продакшна: отдельный TURN, домен + HTTPS (для WebRTC лучше WSS), логирование, watchdog‑процессы.